<html lang="en" class="dark">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>HackAI (Firebase)</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<style>/* keep your styles - omitted for brevity in canvas */</style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 font-mono antialiased">
<!-- same UI elements as your original index.html - modals remain -->

<!-- Important: Add Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
// TODO: Replace with your project's config from Firebase Console
const firebaseConfig = {
apiKey: "REPLACE_WITH_API_KEY",
authDomain: "REPLACE_WITH_PROJECT.firebaseapp.com",
projectId: "REPLACE_WITH_PROJECT_ID",
storageBucket: "REPLACE_WITH_PROJECT.appspot.com",
messagingSenderId: "SENDER_ID",
appId: "APP_ID"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Utility: make a synthetic email from phone so we can use EmailAuth
const phoneToEmail = (phone) => {
// remove non digits, prefix if needed
const cleaned = phone.replace(/\D/g, '') || Date.now().toString();
return `${cleaned}@hackai.local`;
};

// Register user: create firebase auth user (email=phone@hackai.local) then save profile in Firestore
const registerUser = async () => {
const phone = document.getElementById('reg-phone').value.trim();
const name = document.getElementById('reg-name').value.trim();
const surname = document.getElementById('reg-surname').value.trim();
const address = document.getElementById('reg-address').value.trim();
const passport = document.getElementById('reg-passport').value.trim();
const password = document.getElementById('reg-password').value.trim();

if (!(phone && name && surname && address && passport && password)) {
alert('Please fill all fields.');
return;
}

try {
const email = phoneToEmail(phone);
const userCredential = await auth.createUserWithEmailAndPassword(email, password);
const uid = userCredential.user.uid;

await db.collection('users').doc(uid).set({
phone, name, surname, address, passport,
createdAt: firebase.firestore.FieldValue.serverTimestamp(),
plan: { type: 'basic', start: null, expires: null },
isAdmin: false
});

alert('Registered successfully! Please login.');
// optionally open login modal
} catch (err) {
console.error(err);
alert('Register error: ' + err.message);
}
};

// Login user by phone (email synthetic)
const loginUser = async () => {
const phone = document.getElementById('login-phone').value.trim();
const password = document.getElementById('login-password').value.trim();
</html>
